# 网络地址的设定原理

## mac地址和ip地址、子网掩码和默认网关

### MAC地址

MAC（Media Access Control或者Medium Access Control）地址，意译为媒体访问控制，或称为物理地址、硬件地址，用来定义网络设备的位置。在OSI模型中，第三层网络层负责 IP地址，第二层数据链路层则负责 MAC地址。因此一个主机会有一个MAC地址，而每个网络位置会有一个专属于它的IP地址。[1] 
MAC地址是网卡决定的，是固定的。

ip是虚拟地址 
mac是网卡地址全世界只有一种没重复的

#### IP地址

对于IP地址，相信大家都很熟悉，即指使用TCP/IP协议指定给主机的32位地址。IP地址由用点分隔开的4个8八位组构成，如192.168.0.1就是一个IP地址，这种写法叫点分十进制格式。

IP地址由网络地址和主机地址两部分组成，分配给这两部分的位数随地址类（A类、B类、C类等）的不同而不同。网络地址用于路由选择，而主机地址用于在网络或子网内部寻找一个单独的主机。

一个IP地址使得将来自源地址的数据通过路由而传送到目的地址变为可能。

#### MAC地址

对于MAC地址，由于我们不直接和它接触，所以大家不一定很熟悉。在OSI（Open System Interconnection，开放系统互连）7层网络协议（物理层，数据链路层，网络层，传输层，会话层，表示层，应用层）参考模型中，第二层为数据链路层（Data Link）。

它包含两个子层，上一层是逻辑链路控制（LLC：Logical Link Control），下一层即是我们前面所提到的MAC（Media Access Control）层，即介质访问控制层。所谓介质（Media），是指传输信号所通过的多种物理环境。常用网络介质包括电缆
（如：双绞线，同轴电缆，光纤），还有微波、激光、红外线等，有时也称介质为物理介质。

MAC地址也叫物理地址、硬件地址或链路地址，由网络设备制造商生产时写在硬件内部。这个地址与网络无关，也即无论将带有这个地址的硬件（如网卡、集线器、路由器等）接入到网络的何处，它都有相同的MAC地址，MAC地址一般不可改变，不能由用户自己设定。

#### 什么是子网掩码和默认网关

什么是子网掩码 

子网掩码不能单独存在，它必须结合IP地址一起使用。子网掩码只有一个作用，就是将某个IP地址划分成网络地址和主机地址两部分。

子网掩码的设定必须遵循一定的规则。与IP地址相同，子网掩码的长度也是32位，左边是网络位，用二进制数字“1”表示；右边是主机位，用二进制数字“0”表示。附图所示的就是IP地址为“192.168.1.1”和子网掩码为“255.255.255.0”的二进制对照。其中，“1”有24个，代表与此相对应的IP地址左边24位是网络号；“0”有8个，代表与此相对应的IP地址右边8位是主机号。这样，子网掩码就确定了一个IP地址的32位二进制数字中哪些是网络号、哪些是主机号。这对于采用TCP/IP协议的网络来说非常重要，只有通过子网掩码，才能表明一台主机所在的子网与其他子网的关系，使网络正常工作。 

常用的子网掩码 
子网掩码有数百种，这里只介绍最常用的两种子网掩码，它们分别是“255.255.255.0”和“255.255.0.0”。

1.子网掩码是“255.255.255.0”的网络：最后面一个数字可以在0~255范围内任意变化，因此可以提供256个IP地址。但是实际可用的IP地址数量是256-2，即254个，因为主机号不能全是“0”或全是“1”。

2.子网掩码是“255.255.0.0”的网络：后面两个数字可以在0~255范围内任意变化，可以提供2552个IP地址。但是实际可用的IP地址数量是2552-2，即65023个。

IP地址的子网掩码设置不是任意的。如果将子网掩码设置过大，也就是说子网范围扩大，那么，根据子网寻径规则，很可能发往和本地机不在同一子网内的目的机的数据，会因为错误的判断而认为目的机是在同一子网内，那么，数据包将在本子网内循环，直到超时并抛弃，使数据不能正确到达目的机，导致网络传输错误；如果将子网掩码设置得过小，那么就会将本来属于同一子网内的机器之间的通信当做是跨子网传输，数据包都交给缺省网关处理，这样势必增加缺省网关的负担，造成网络效率下降。因此，子网掩码应该根据网络的规模进行设置。

如果一个网络的规模不超过254台电脑，采用“255.255.255.0”作为子网掩码就可以了，现在大多数局域网都不会超过这个数字，因此“255.255.255.0”是最常用的IP地址子网掩码；笔者见到的最大规模的中小学校园网具有1500多台电脑，这种规模的局域网可以使用“255.255.0.0”。

默认子网掩码 

在Windows 2000 Server中，如果给一个网卡指定IP地址，系统会自动填入一个默认的子网掩码。这是Windows 2000 Server为了节省用户输入时间自动产生的子网掩码。比如，局域网最常使用的IP地址“192.168.x.x”默认的子网掩码是“255.255.255.0”。一般情况下，IP地址使用默认子网掩码就可以了。

就好像一个房间可以有多扇门一样，一台主机可以有多个网关。默认网关的意思是一台主机如果找不到可用的网关，就把数据包发给默认指定的网关，由这个网关来处理数据包。现在主机使用的网关，一般指的是默认网关。
如何设置默认网关

一台电脑的默认网关是不可以随随便便指定的，必须正确地指定，否则一台电脑就会将数据包发给不是网关的电脑，从而无法与其他网络的电脑通信。默认网关的设定有手动设置和自动设置两种方式。

##### 手动设置

手动设置适用于电脑数量比较少、TCP/IP参数基本不变的情况，比如只有几台到十几台电脑。因为这种方法需要在联入网络的每台电脑上设置“默认网关”，非常费劲，一旦因为迁移等原因导致必须修改默认网关的IP地址，就会给网管带来很大的麻烦，所以不推荐使用。

在Windows 9x中，设置默认网关的方法是在“网上邻居”上右击，在弹出的菜单中点击“属性”，在网络属性对话框中选择“TCP/IP协议”，点击“属性”，在“默认网关”选项卡中填写新的默认网关的IP地址就可以了。

需要特别注意的是：默认网关必须是电脑自己所在的网段中的IP地址，而不能填写其他网段中的IP地址。

##### 自动设置

自动设置就是利用DHCP服务器来自动给网络中的电脑分配IP地址、子网掩码和默认网关。这样做的好处是一旦网络的默认网关发生了变化时，只要更改了DHCP服务器中默认网关的设置，那么网络中所有的电脑均获得了新的默认网关的IP地址。这种方法适用于网络规模较大、TCP/IP参数有可能变动的网络。

另外一种自动获得网关的办法是通过安装代理服务器软件（如MS Proxy）的客户端程序来自动获得，其原理和方法和DHCP有相似之处。

## 内网IP和公网IP的区别

### 什么是内网IP：

一些小型企业或者学校，通常都是申请一个固定的IP地址，然后通过IP共享（IP Sharing），使用整个公司或学校的机器都能够访问互联网。而这些企业或学校的机器使用的IP地址就是内网IP，内网IP是在规划IPv4协议时，考虑到IP地址资源可能不足，就专门为内部网设计私有IP地址（或称之为保留地址），一般常用内网IP地址都是这种形式的：10.X.X.X、172.16.X.X-172.31.X.X、192.168.X.X等。需要注意的是，内网的计算机可向Internet上的其他计算机发送连接请求，但Internet上其他的计算机无法向内网的计算机发送连接请求。我们平时可能在内网机器上搭建过网站或者FTP服务器，而在外网是不能访问该网站和FTP服务器的，原因就在于此。

### 什么是公网IP（外网IP）：

公网IP就是除了保留IP地址以外的IP地址，可以与Internet上的其他计算机随意互相访问。我们通常所说的IP地址，其实就是指的公网IP。互联网上的每台计算机都有一个独立的IP地址，该IP地址唯一确定互联网上的一台计算机。这里的IP地址就是指的公网IP地址。

### 怎样理解互联网上的每台计算机都有一个唯一的IP地址：

其实，互联网上的计算机是通过“公网IP＋内网IP”来唯一确定的，就像很多大楼都是201房间一样，房间号可能一样，但是大楼肯定是唯一的。公网IP地址和内网IP地址也是同样，不同企业或学校的机器可能有相同的内网IP地址，但是他们的公网IP地址肯定不同。那么这些企业或学校的计算机是怎样IP地址共享的呢？这就需要使用NAT（Network Address Translation,网络地址转换）功能。当内部计算机要连接互联网时，首先需要通过NAT技术，将内部计算机数据包中有关IP地址的设置都设成NAT主机的公共IP地址，然后再传送到Internet，虽然内部计算机使用的是私有IP地址，但在连接Internet时，就可以通过NAT主机的NAT技术，将内网我IP地址修改为公网IP地址，如此一来，内网计算机就可以向Internet请求数据了。

### 什么是NAT（Network Address Translation,网络地址转换）：

网络地址转换(NAT,Network Address Translation)属接入广域网(WAN)技术,是一种将私有(保留)地址转化为合法IP地址的转换技术,它被广泛应用于各种类型Internet接入方式和各种类型的网络中。原因很简单，NAT不仅完美地解决了lP地址不足的问题，而且还能够有效地避免来自网络外部的攻击，隐藏并保护网络内部的计算机。

虽然NAT可以借助于某些代理服务器来实现，但考虑到运算成本和网络性能，很多时候都是在路由器上来实现的。

随着接入Internet的计算机数量的不断猛增，IP地址资源也就愈加显得捉襟见肘。事实 上，除了中国教育和科研计算机网(CERNET)外，一般用户几乎申请不到整段的C类IP地址。在其他ISP那里，即使是拥有几百台计算机的大型局域网用户，当他们申请IP地址时，所分配的地址也不过只有几个或十几个IP地址。显然，这样少的IP地址根本无法满足网络用户的需求，于是也就产生了NAT技 术。

## 怎样设置路由器

### 01. 

如果线都已经接好．我们这个时候随便打开一台连好的ＰＣ电脑．打开网上邻居属性

![](http://b.hiphotos.baidu.com/exp/w=500/sign=0ba22c5ef2d3572c66e29cdcba126352/1b4c510fd9f9d72a612a6baad42a2834349bbb3e.jpg)

### 02. 

然后打开本地连接属性

![](http://c.hiphotos.baidu.com/exp/w=500/sign=d166fef9ca8065387beaa413a7dca115/cf1b9d16fdfaaf51b1abfa088c5494eef01f7a38.jpg)

### 03. 

然后打开tcp/ip协议属性

![](http://e.hiphotos.baidu.com/exp/w=500/sign=cbbe0c20d933c895a67e987be1127397/4bed2e738bd4b31c439bef0c87d6277f9f2ff8e6.jpg)

### 04. 

设置ip为192.168.1.2子网:255.255.255.0网关:192.168.1.1。确定，DNS在配置路由器完后在行设置.注：如果是98和me系统，请到控制面板网络连接去设置．这里xp为例

![](http://f.hiphotos.baidu.com/exp/w=500/sign=806ca99690ef76c6d0d2fb2bad17fdf6/838ba61ea8d3fd1f2485d98d304e251f94ca5ffc.jpg)

### 05. 

这里提醒一下大家,ip设置网段,可以设置在192.168.1.2-192.168.1.254之间都可以,不要将同一IP设置为多台电脑,这样就会引起IP冲突了.切记.好了当设置到这里.我就可以打开桌面的InternetExplorer,输入192.168.1.1回车！

![](http://b.hiphotos.baidu.com/exp/w=500/sign=bf415552ad6eddc426e7b4fb09dab6a2/eac4b74543a982267e4950908a82b9014b90ebf9.jpg)

### 06.

这里提示输入用户名和密码,默认的用户名和密码都是admin,在路由器说明书上也有写着.输入后按回车，即可进入路由器配置界面.注:tplink的路由器默认IP基本都是192.168.1.1密码基本都是admin首次进入路由器界面

![](http://a.hiphotos.baidu.com/exp/w=500/sign=198be3ccd11373f0f53f6f9f940e4b8b/8601a18b87d6277f56e7498f28381f30e824fc94.jpg)

### 07.

这里我们选择设置向导

![](http://c.hiphotos.baidu.com/exp/w=500/sign=4730fc7c43166d223877159476220945/3b87e950352ac65c02f31dc4fbf2b21192138a96.jpg)

### 08.

然后下一步

![](http://a.hiphotos.baidu.com/exp/w=500/sign=77e9ef0c87d6277fe912323818391f63/472309f79052982282e64274d7ca7bcb0b46d4b4.jpg)

### 09.

这里选择adsl虚拟拨号,我们大多都是选择它的，其他的静态那是专线用户选择的，我们这里不做详细介绍,知道宽带用户,铁通,网通等虚拟拨号用户,选择它就行了,然后下一步

![](http://e.hiphotos.baidu.com/exp/w=500/sign=6ee54274d7ca7bcb7d7bc72f8e086b3f/cb8065380cd791238b36efc3ad345982b3b780b6.jpg)

### 10. 

在点下一步,按完成即可设置好路由

![](http://e.hiphotos.baidu.com/exp/w=500/sign=e1d8ab5ae71190ef01fb92dffe1a9df7/32fa828ba61ea8d399f20fb3970a304e241f58b0.jpg)

### 11. 

然后在设置在点网络参数,WAN口设置

![](http://d.hiphotos.baidu.com/exp/w=500/sign=5effaf799925bc312b5d01986edf8de7/71cf3bc79f3df8dca20af526cd11728b47102855.jpg)

### 12.

到了这里路由器里的配置一切都设置好了,现在我们只有重起路由器就OK了.点系统工具,重起路由器,几秒钟后就好了

![](http://d.hiphotos.baidu.com/exp/w=500/sign=ebc374409f3df8dca63d8f91fd1072bf/0e2442a7d933c8954a4fe2ccd11373f082020057.jpg)

### 13.

这个时候我们关掉配置的网页窗口,接上其他的电脑就可以上网了

